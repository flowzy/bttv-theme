{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_index","chrome","runtime","sendMessage","bttv","dev","enabled","cdn","getURL","mockups","Mockups","debug","Debug","storage","sync","settings","get","item","Object","keys","log","localTheme","window","localStorage","getItem","JSON","parse","$","html","stylesheet","appendTo","when","then","theme","name","url","isOutdated","Date","getTime","last_updated","chatSettings","darkMode","setItem","stringify","removeItem","request","ajax","method","cache","fail","error","done","remove","BetterTTV","./components/index","2","_classCallCheck","instance","Constructor","TypeError","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","this","__prefix","input","console","warn","3","undefined","_debug","_mockups","./debug","./mockups","4","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_Debug","_this","getPrototypeOf","arguments"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _index = require('./components/index');\n\nchrome.runtime.sendMessage('change icon');\n\n// imports\n\n\n// variables\nvar bttv = {\n    dev: {\n        enabled: false,\n        cdn: chrome.runtime.getURL('')\n    },\n    mockups: new _index.Mockups(),\n    debug: new _index.Debug(),\n    storage: chrome.storage.sync,\n    settings: {}\n};\n\n// ****************\n// Settings\n// ****************\n\n// asynchronously get all settings\nbttv.storage.get('settings', function (item) {\n\n    // do nothing if settings do not exist\n    if (!Object.keys(item).length) return bttv.debug.log('Settings: not found (empty).');\n\n    // save settings into a global variable\n    bttv.settings = item.settings;\n\n    // log\n    bttv.debug.log('Settings: successfully loaded.');\n});\n\n// ****************\n// Theme\n// ****************\n\n// get theme from localStorage\nvar localTheme = window.localStorage.getItem('bttv--theme') ? JSON.parse(window.localStorage.getItem('bttv--theme')) : '';\n$('<style id=\"bttv__theme\" />').html(localTheme.stylesheet).appendTo('head');\n\n// wait for settings to load\n$.when(bttv.settings.length).then(function () {\n\n    if (bttv.settings.theme) {\n        var name = bttv.settings.theme;\n        var url = bttv.dev.cdn + 'css/theme-' + bttv.settings.theme + '.css';\n        var isOutdated = localTheme ? (new Date().getTime() - localTheme.last_updated) / (1000 * 60 * 60) >= 6 : true;\n\n        // do not show theme if old header found\n        if ($('#site_header').length) return;\n\n        // disable twitch's dark style for chat\n        var chatSettings = JSON.parse(window.localStorage.getItem('chatSettings'));\n        if (chatSettings !== null && chatSettings.darkMode) {\n            chatSettings.darkMode = false;\n            window.localStorage.setItem('chatSettings', JSON.stringify(chatSettings));\n        }\n\n        // if dev mode is enabled, append stylesheet without caching it\n        if (bttv.dev.enabled) {\n            $('<link rel=\"stylesheet\" type=\"text/css\" href=\"' + url + '\">').appendTo('head');\n\n            if (window.localStorage.getItem('bttv--theme')) window.localStorage.removeItem('bttv--theme');\n\n            return;\n        }\n\n        // update theme if is outdated or not saved locally\n        if (!localTheme || isOutdated) {\n            bttv.debug.log('Theme: saving stylesheet locally.');\n\n            var request = $.ajax({\n                url: url,\n                method: 'GET',\n                cache: false\n            });\n\n            request.fail(function () {\n                bttv.debug.error('Theme: could not connect to the server.');\n            });\n\n            request.done(function (stylesheet) {\n                bttv.debug.log('Theme: received \"' + name + '\" stylesheet.');\n\n                $('style#bttv__theme').html(stylesheet);\n\n                var theme = {\n                    name: name,\n                    last_updated: new Date().getTime(),\n                    stylesheet: stylesheet\n                };\n\n                window.localStorage.setItem('bttv--theme', JSON.stringify(theme));\n            });\n        }\n    } else {\n        if (window.localStorage.getItem('bttv--theme')) {\n            window.localStorage.removeItem('bttv--theme');\n            $('style#bttv__theme').remove();\n        }\n    }\n});\n\nwindow.BetterTTV = bttv;\n\n},{\"./components/index\":3}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Debug = exports.Debug = function () {\n    function Debug() {\n        _classCallCheck(this, Debug);\n\n        this.__prefix = '[BetterTTV]';\n    }\n\n    _createClass(Debug, [{\n        key: 'log',\n        value: function log(input) {\n            console.log(this.__prefix, input);\n        }\n    }, {\n        key: 'error',\n        value: function error(input) {\n            console.error(this.__prefix, input);\n        }\n    }, {\n        key: 'warn',\n        value: function warn(input) {\n            console.warn(this.__prefix, input);\n        }\n    }]);\n\n    return Debug;\n}();\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Mockups = exports.Debug = undefined;\n\nvar _debug = require('./debug');\n\nvar _mockups = require('./mockups');\n\nexports.Debug = _debug.Debug;\nexports.Mockups = _mockups.Mockups;\n\n},{\"./debug\":2,\"./mockups\":4}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Mockups = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _debug = require('./debug');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Mockups = exports.Mockups = function (_Debug) {\n    _inherits(Mockups, _Debug);\n\n    function Mockups() {\n        _classCallCheck(this, Mockups);\n\n        var _this = _possibleConstructorReturn(this, (Mockups.__proto__ || Object.getPrototypeOf(Mockups)).call(this));\n\n        _this.mockups = {\n            // example: require('../../templates/example.html')\n        };\n        return _this;\n    }\n\n    _createClass(Mockups, [{\n        key: 'get',\n        value: function get() {\n            var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'undefined';\n\n            return this.mockups[name] ? this.mockups[name] : this.error('Mockups: \"' + name + '\" not found');\n        }\n    }]);\n\n    return Mockups;\n}(_debug.Debug);\n\n},{\"./debug\":2}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFxhcHAuanMiLCJzcmNcXGpzXFxjb21wb25lbnRzXFxkZWJ1Zy5qcyIsInNyY1xcanNcXGNvbXBvbmVudHNcXGluZGV4LmpzIiwic3JjXFxqc1xcY29tcG9uZW50c1xcbW9ja3Vwcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDR0E7O0FBSEEsT0FBTyxPQUFQLENBQWUsV0FBZixDQUEyQixhQUEzQjs7QUFFQTs7O0FBR0E7QUFDQSxJQUFJLE9BQU87QUFDUCxTQUFLO0FBQ0QsaUJBQVksS0FEWDtBQUVELGFBQVksT0FBTyxPQUFQLENBQWUsTUFBZixDQUFzQixFQUF0QjtBQUZYLEtBREU7QUFLUCxhQUFZLG9CQUxMO0FBTVAsV0FBWSxrQkFOTDtBQU9QLGFBQVksT0FBTyxPQUFQLENBQWUsSUFQcEI7QUFRUCxjQUFZO0FBUkwsQ0FBWDs7QUFXQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWlCLFVBQWpCLEVBQTZCLFVBQUUsSUFBRixFQUFZOztBQUVyQztBQUNBLFFBQUssQ0FBQyxPQUFPLElBQVAsQ0FBWSxJQUFaLEVBQWtCLE1BQXhCLEVBQWlDLE9BQU8sS0FBSyxLQUFMLENBQVcsR0FBWCxDQUFlLDhCQUFmLENBQVA7O0FBRWpDO0FBQ0EsU0FBSyxRQUFMLEdBQWdCLEtBQUssUUFBckI7O0FBRUE7QUFDQSxTQUFLLEtBQUwsQ0FBVyxHQUFYLENBQWUsZ0NBQWY7QUFFSCxDQVhEOztBQWFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUksYUFBYSxPQUFPLFlBQVAsQ0FBb0IsT0FBcEIsQ0FBNEIsYUFBNUIsSUFBNkMsS0FBSyxLQUFMLENBQVksT0FBTyxZQUFQLENBQW9CLE9BQXBCLENBQTRCLGFBQTVCLENBQVosQ0FBN0MsR0FBd0csRUFBekg7QUFDQSxFQUFFLDRCQUFGLEVBQWdDLElBQWhDLENBQXNDLFdBQVcsVUFBakQsRUFBOEQsUUFBOUQsQ0FBdUUsTUFBdkU7O0FBRUE7QUFDQSxFQUFFLElBQUYsQ0FBUSxLQUFLLFFBQUwsQ0FBYyxNQUF0QixFQUErQixJQUEvQixDQUFxQyxZQUFNOztBQUV2QyxRQUFLLEtBQUssUUFBTCxDQUFjLEtBQW5CLEVBQTJCO0FBQ3ZCLFlBQUksT0FBYyxLQUFLLFFBQUwsQ0FBYyxLQUFoQztBQUNBLFlBQUksTUFBaUIsS0FBSyxHQUFMLENBQVMsR0FBMUIsa0JBQTBDLEtBQUssUUFBTCxDQUFjLEtBQXhELFNBQUo7QUFDQSxZQUFJLGFBQWMsYUFBYyxDQUFDLElBQUksSUFBSixHQUFXLE9BQVgsS0FBdUIsV0FBVyxZQUFuQyxLQUFvRCxPQUFPLEVBQVAsR0FBWSxFQUFoRSxDQUFELElBQXlFLENBQXRGLEdBQTBGLElBQTVHOztBQUVBO0FBQ0EsWUFBSyxFQUFFLGNBQUYsRUFBa0IsTUFBdkIsRUFBZ0M7O0FBRWhDO0FBQ0EsWUFBSSxlQUFlLEtBQUssS0FBTCxDQUFXLE9BQU8sWUFBUCxDQUFvQixPQUFwQixDQUE0QixjQUE1QixDQUFYLENBQW5CO0FBQ0EsWUFBSyxpQkFBaUIsSUFBakIsSUFBeUIsYUFBYSxRQUEzQyxFQUFzRDtBQUNsRCx5QkFBYSxRQUFiLEdBQXdCLEtBQXhCO0FBQ0EsbUJBQU8sWUFBUCxDQUFvQixPQUFwQixDQUE2QixjQUE3QixFQUE2QyxLQUFLLFNBQUwsQ0FBZ0IsWUFBaEIsQ0FBN0M7QUFDSDs7QUFFRDtBQUNBLFlBQUssS0FBSyxHQUFMLENBQVMsT0FBZCxFQUF3QjtBQUNwQixnRUFBa0QsR0FBbEQsU0FBMkQsUUFBM0QsQ0FBb0UsTUFBcEU7O0FBRUEsZ0JBQUksT0FBTyxZQUFQLENBQW9CLE9BQXBCLENBQTRCLGFBQTVCLENBQUosRUFDSSxPQUFPLFlBQVAsQ0FBb0IsVUFBcEIsQ0FBK0IsYUFBL0I7O0FBRUo7QUFDSDs7QUFFRDtBQUNBLFlBQUssQ0FBQyxVQUFELElBQWUsVUFBcEIsRUFBaUM7QUFDN0IsaUJBQUssS0FBTCxDQUFXLEdBQVgsQ0FBZSxtQ0FBZjs7QUFFQSxnQkFBSSxVQUFVLEVBQUUsSUFBRixDQUFPO0FBQ2pCLHFCQUFLLEdBRFk7QUFFakIsd0JBQVEsS0FGUztBQUdqQix1QkFBTztBQUhVLGFBQVAsQ0FBZDs7QUFNQSxvQkFBUSxJQUFSLENBQWMsWUFBTTtBQUNoQixxQkFBSyxLQUFMLENBQVcsS0FBWCxDQUFpQix5Q0FBakI7QUFDSCxhQUZEOztBQUlBLG9CQUFRLElBQVIsQ0FBYyxVQUFDLFVBQUQsRUFBZ0I7QUFDMUIscUJBQUssS0FBTCxDQUFXLEdBQVgsdUJBQW1DLElBQW5DOztBQUVBLGtCQUFFLG1CQUFGLEVBQXVCLElBQXZCLENBQTZCLFVBQTdCOztBQUVBLG9CQUFJLFFBQVE7QUFDUiwwQkFBTSxJQURFO0FBRVIsa0NBQWMsSUFBSSxJQUFKLEdBQVcsT0FBWCxFQUZOO0FBR1IsZ0NBQVk7QUFISixpQkFBWjs7QUFNQSx1QkFBTyxZQUFQLENBQW9CLE9BQXBCLENBQTRCLGFBQTVCLEVBQTJDLEtBQUssU0FBTCxDQUFnQixLQUFoQixDQUEzQztBQUNILGFBWkQ7QUFhSDtBQUNKLEtBckRELE1BcURPO0FBQ0gsWUFBSyxPQUFPLFlBQVAsQ0FBb0IsT0FBcEIsQ0FBNEIsYUFBNUIsQ0FBTCxFQUFrRDtBQUM5QyxtQkFBTyxZQUFQLENBQW9CLFVBQXBCLENBQStCLGFBQS9CO0FBQ0EsY0FBRSxtQkFBRixFQUF1QixNQUF2QjtBQUNIO0FBQ0o7QUFFSixDQTlERDs7QUFnRUEsT0FBTyxTQUFQLEdBQW1CLElBQW5COzs7Ozs7Ozs7Ozs7O0lDNUdhLEssV0FBQSxLO0FBQ1QscUJBQWU7QUFBQTs7QUFDWCxhQUFLLFFBQUwsR0FBZ0IsYUFBaEI7QUFDSDs7Ozs0QkFDSSxLLEVBQU87QUFDUixvQkFBUSxHQUFSLENBQVksS0FBSyxRQUFqQixFQUEyQixLQUEzQjtBQUNIOzs7OEJBQ00sSyxFQUFPO0FBQ1Ysb0JBQVEsS0FBUixDQUFjLEtBQUssUUFBbkIsRUFBNkIsS0FBN0I7QUFDSDs7OzZCQUNLLEssRUFBTztBQUNULG9CQUFRLElBQVIsQ0FBYSxLQUFLLFFBQWxCLEVBQTRCLEtBQTVCO0FBQ0g7Ozs7Ozs7Ozs7Ozs7O0FDWkw7O0FBQ0E7O1FBR0ksSztRQUNBLE87Ozs7Ozs7Ozs7OztBQ0xKOzs7Ozs7OztJQUVhLE8sV0FBQSxPOzs7QUFDVCx1QkFBZTtBQUFBOztBQUFBOztBQUdYLGNBQUssT0FBTCxHQUFlO0FBQ1g7QUFEVyxTQUFmO0FBSFc7QUFNZDs7Ozs4QkFFd0I7QUFBQSxnQkFBcEIsSUFBb0IsdUVBQWIsV0FBYTs7QUFDckIsbUJBQU8sS0FBSyxPQUFMLENBQWEsSUFBYixJQUFxQixLQUFLLE9BQUwsQ0FBYSxJQUFiLENBQXJCLEdBQTBDLEtBQUssS0FBTCxnQkFBd0IsSUFBeEIsaUJBQWpEO0FBQ0giLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoJ2NoYW5nZSBpY29uJylcclxuXHJcbi8vIGltcG9ydHNcclxuaW1wb3J0IHsgRGVidWcsIE1vY2t1cHMgfSBmcm9tICcuL2NvbXBvbmVudHMvaW5kZXgnXHJcblxyXG4vLyB2YXJpYWJsZXNcclxubGV0IGJ0dHYgPSB7XHJcbiAgICBkZXY6IHtcclxuICAgICAgICBlbmFibGVkOiAgICBmYWxzZSxcclxuICAgICAgICBjZG46ICAgICAgICBjaHJvbWUucnVudGltZS5nZXRVUkwoJycpXHJcbiAgICB9LFxyXG4gICAgbW9ja3VwczogICAgbmV3IE1vY2t1cHMsXHJcbiAgICBkZWJ1ZzogICAgICBuZXcgRGVidWcsXHJcbiAgICBzdG9yYWdlOiAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLFxyXG4gICAgc2V0dGluZ3M6ICAge31cclxufVxyXG5cclxuLy8gKioqKioqKioqKioqKioqKlxyXG4vLyBTZXR0aW5nc1xyXG4vLyAqKioqKioqKioqKioqKioqXHJcblxyXG4vLyBhc3luY2hyb25vdXNseSBnZXQgYWxsIHNldHRpbmdzXHJcbmJ0dHYuc3RvcmFnZS5nZXQoJ3NldHRpbmdzJywgKCBpdGVtICkgPT4ge1xyXG4gICAgXHJcbiAgICAvLyBkbyBub3RoaW5nIGlmIHNldHRpbmdzIGRvIG5vdCBleGlzdFxyXG4gICAgaWYgKCAhT2JqZWN0LmtleXMoaXRlbSkubGVuZ3RoICkgcmV0dXJuIGJ0dHYuZGVidWcubG9nKCdTZXR0aW5nczogbm90IGZvdW5kIChlbXB0eSkuJylcclxuXHJcbiAgICAvLyBzYXZlIHNldHRpbmdzIGludG8gYSBnbG9iYWwgdmFyaWFibGVcclxuICAgIGJ0dHYuc2V0dGluZ3MgPSBpdGVtLnNldHRpbmdzXHJcblxyXG4gICAgLy8gbG9nXHJcbiAgICBidHR2LmRlYnVnLmxvZygnU2V0dGluZ3M6IHN1Y2Nlc3NmdWxseSBsb2FkZWQuJylcclxuXHJcbn0pXHJcblxyXG4vLyAqKioqKioqKioqKioqKioqXHJcbi8vIFRoZW1lXHJcbi8vICoqKioqKioqKioqKioqKipcclxuXHJcbi8vIGdldCB0aGVtZSBmcm9tIGxvY2FsU3RvcmFnZVxyXG5sZXQgbG9jYWxUaGVtZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYnR0di0tdGhlbWUnKSA/IEpTT04ucGFyc2UoIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYnR0di0tdGhlbWUnKSApIDogJydcclxuJCgnPHN0eWxlIGlkPVwiYnR0dl9fdGhlbWVcIiAvPicpLmh0bWwoIGxvY2FsVGhlbWUuc3R5bGVzaGVldCApLmFwcGVuZFRvKCdoZWFkJylcclxuXHJcbi8vIHdhaXQgZm9yIHNldHRpbmdzIHRvIGxvYWRcclxuJC53aGVuKCBidHR2LnNldHRpbmdzLmxlbmd0aCApLnRoZW4oICgpID0+IHtcclxuXHJcbiAgICBpZiAoIGJ0dHYuc2V0dGluZ3MudGhlbWUgKSB7XHJcbiAgICAgICAgbGV0IG5hbWUgICAgICAgID0gYnR0di5zZXR0aW5ncy50aGVtZVxyXG4gICAgICAgIGxldCB1cmwgICAgICAgICA9IGAke2J0dHYuZGV2LmNkbn1jc3MvdGhlbWUtJHtidHR2LnNldHRpbmdzLnRoZW1lfS5jc3NgXHJcbiAgICAgICAgbGV0IGlzT3V0ZGF0ZWQgID0gbG9jYWxUaGVtZSA/ICgobmV3IERhdGUoKS5nZXRUaW1lKCkgLSBsb2NhbFRoZW1lLmxhc3RfdXBkYXRlZCkgLyAoMTAwMCAqIDYwICogNjApKSA+PSA2IDogdHJ1ZVxyXG5cclxuICAgICAgICAvLyBkbyBub3Qgc2hvdyB0aGVtZSBpZiBvbGQgaGVhZGVyIGZvdW5kXHJcbiAgICAgICAgaWYgKCAkKCcjc2l0ZV9oZWFkZXInKS5sZW5ndGggKSByZXR1cm5cclxuXHJcbiAgICAgICAgLy8gZGlzYWJsZSB0d2l0Y2gncyBkYXJrIHN0eWxlIGZvciBjaGF0XHJcbiAgICAgICAgbGV0IGNoYXRTZXR0aW5ncyA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjaGF0U2V0dGluZ3MnKSlcclxuICAgICAgICBpZiAoIGNoYXRTZXR0aW5ncyAhPT0gbnVsbCAmJiBjaGF0U2V0dGluZ3MuZGFya01vZGUgKSB7XHJcbiAgICAgICAgICAgIGNoYXRTZXR0aW5ncy5kYXJrTW9kZSA9IGZhbHNlXHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSggJ2NoYXRTZXR0aW5ncycsIEpTT04uc3RyaW5naWZ5KCBjaGF0U2V0dGluZ3MgKSApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiBkZXYgbW9kZSBpcyBlbmFibGVkLCBhcHBlbmQgc3R5bGVzaGVldCB3aXRob3V0IGNhY2hpbmcgaXRcclxuICAgICAgICBpZiAoIGJ0dHYuZGV2LmVuYWJsZWQgKSB7XHJcbiAgICAgICAgICAgICQoYDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiB0eXBlPVwidGV4dC9jc3NcIiBocmVmPVwiJHt1cmx9XCI+YCkuYXBwZW5kVG8oJ2hlYWQnKVxyXG5cclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYnR0di0tdGhlbWUnKSlcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYnR0di0tdGhlbWUnKVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyB1cGRhdGUgdGhlbWUgaWYgaXMgb3V0ZGF0ZWQgb3Igbm90IHNhdmVkIGxvY2FsbHlcclxuICAgICAgICBpZiAoICFsb2NhbFRoZW1lIHx8IGlzT3V0ZGF0ZWQgKSB7XHJcbiAgICAgICAgICAgIGJ0dHYuZGVidWcubG9nKCdUaGVtZTogc2F2aW5nIHN0eWxlc2hlZXQgbG9jYWxseS4nKVxyXG5cclxuICAgICAgICAgICAgbGV0IHJlcXVlc3QgPSAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXF1ZXN0LmZhaWwoICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0dHYuZGVidWcuZXJyb3IoJ1RoZW1lOiBjb3VsZCBub3QgY29ubmVjdCB0byB0aGUgc2VydmVyLicpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICByZXF1ZXN0LmRvbmUoIChzdHlsZXNoZWV0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidHR2LmRlYnVnLmxvZyhgVGhlbWU6IHJlY2VpdmVkIFwiJHtuYW1lfVwiIHN0eWxlc2hlZXQuYClcclxuXHJcbiAgICAgICAgICAgICAgICAkKCdzdHlsZSNidHR2X190aGVtZScpLmh0bWwoIHN0eWxlc2hlZXQgKVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCB0aGVtZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlZDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzaGVldDogc3R5bGVzaGVldFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYnR0di0tdGhlbWUnLCBKU09OLnN0cmluZ2lmeSggdGhlbWUgKSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICggd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdidHR2LS10aGVtZScpICkge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2J0dHYtLXRoZW1lJylcclxuICAgICAgICAgICAgJCgnc3R5bGUjYnR0dl9fdGhlbWUnKS5yZW1vdmUoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pXHJcblxyXG53aW5kb3cuQmV0dGVyVFRWID0gYnR0djsiLCJleHBvcnQgY2xhc3MgRGVidWcge1xyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuX19wcmVmaXggPSAnW0JldHRlclRUVl0nO1xyXG4gICAgfVxyXG4gICAgbG9nIChpbnB1dCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX19wcmVmaXgsIGlucHV0KTtcclxuICAgIH1cclxuICAgIGVycm9yIChpbnB1dCkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5fX3ByZWZpeCwgaW5wdXQpO1xyXG4gICAgfVxyXG4gICAgd2FybiAoaW5wdXQpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4odGhpcy5fX3ByZWZpeCwgaW5wdXQpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuL2RlYnVnJ1xyXG5pbXBvcnQgeyBNb2NrdXBzIH0gZnJvbSAnLi9tb2NrdXBzJ1xyXG5cclxuZXhwb3J0IHtcclxuICAgIERlYnVnLFxyXG4gICAgTW9ja3Vwc1xyXG59IiwiaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuL2RlYnVnJ1xyXG5cclxuZXhwb3J0IGNsYXNzIE1vY2t1cHMgZXh0ZW5kcyBEZWJ1ZyB7XHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgc3VwZXIoKVxyXG5cclxuICAgICAgICB0aGlzLm1vY2t1cHMgPSB7XHJcbiAgICAgICAgICAgIC8vIGV4YW1wbGU6IHJlcXVpcmUoJy4uLy4uL3RlbXBsYXRlcy9leGFtcGxlLmh0bWwnKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgKG5hbWUgPSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vY2t1cHNbbmFtZV0gPyB0aGlzLm1vY2t1cHNbbmFtZV0gOiB0aGlzLmVycm9yKGBNb2NrdXBzOiBcIiR7bmFtZX1cIiBub3QgZm91bmRgKVxyXG4gICAgfVxyXG59Il19\n"]}