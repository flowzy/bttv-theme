{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_index","chrome","runtime","sendMessage","bttv","dev","enabled","cdn","getURL","mockups","Mockups","debug","Debug","storage","sync","settings","get","item","Object","keys","log","localTheme","window","localStorage","getItem","JSON","parse","$","html","stylesheet","appendTo","when","then","theme","name","url","isOutdated","Date","getTime","last_updated","chatSettings","darkMode","setItem","stringify","removeItem","request","ajax","method","cache","fail","error","done","remove","BetterTTV","./components/index","2","_classCallCheck","instance","Constructor","TypeError","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","this","__prefix","input","console","warn","3","undefined","_debug","_mockups","./debug","./mockups","4","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_Debug","_this","getPrototypeOf","arguments"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _index = require('./components/index');\n\nchrome.runtime.sendMessage('change icon');\n\n// imports\n\n\n// variables\nvar bttv = {\n    dev: {\n        enabled: true,\n        cdn: chrome.runtime.getURL('')\n    },\n    mockups: new _index.Mockups(),\n    debug: new _index.Debug(),\n    storage: chrome.storage.sync,\n    settings: {}\n};\n\n// ****************\n// Settings\n// ****************\n\n// asynchronously get all settings\nbttv.storage.get('settings', function (item) {\n\n    // do nothing if settings do not exist\n    if (!Object.keys(item).length) return bttv.debug.log('Settings: not found (empty).');\n\n    // save settings into a global variable\n    bttv.settings = item.settings;\n\n    // log\n    bttv.debug.log('Settings: successfully loaded.');\n});\n\n// ****************\n// Theme\n// ****************\n\n// get theme from localStorage\nvar localTheme = window.localStorage.getItem('bttv--theme') ? JSON.parse(window.localStorage.getItem('bttv--theme')) : '';\n$('<style id=\"bttv__theme\" />').html(localTheme.stylesheet).appendTo('head');\n\n// wait for settings to load\n$.when(bttv.settings.length).then(function () {\n\n    if (bttv.settings.theme) {\n        var name = bttv.settings.theme;\n        var url = bttv.dev.cdn + 'css/theme-' + bttv.settings.theme + '.css';\n        var isOutdated = localTheme ? (new Date().getTime() - localTheme.last_updated) / (1000 * 60 * 60) >= 6 : true;\n\n        // do not show theme if old header found\n        if ($('#site_header').length) return;\n\n        // disable twitch's dark style for chat\n        var chatSettings = JSON.parse(window.localStorage.getItem('chatSettings'));\n        if (chatSettings !== null && chatSettings.darkMode) {\n            chatSettings.darkMode = false;\n            window.localStorage.setItem('chatSettings', JSON.stringify(chatSettings));\n        }\n\n        // if dev mode is enabled, append stylesheet without caching it\n        if (bttv.dev.enabled) {\n            $('<link rel=\"stylesheet\" type=\"text/css\" href=\"' + url + '\">').appendTo('head');\n\n            if (window.localStorage.getItem('bttv--theme')) window.localStorage.removeItem('bttv--theme');\n\n            return;\n        }\n\n        // update theme if is outdated or not saved locally\n        if (!localTheme || isOutdated) {\n            bttv.debug.log('Theme: saving stylesheet locally.');\n\n            var request = $.ajax({\n                url: url,\n                method: 'GET',\n                cache: false\n            });\n\n            request.fail(function () {\n                bttv.debug.error('Theme: could not connect to the server.');\n            });\n\n            request.done(function (stylesheet) {\n                bttv.debug.log('Theme: received \"' + name + '\" stylesheet.');\n\n                $('style#bttv__theme').html(stylesheet);\n\n                var theme = {\n                    name: name,\n                    last_updated: new Date().getTime(),\n                    stylesheet: stylesheet\n                };\n\n                window.localStorage.setItem('bttv--theme', JSON.stringify(theme));\n            });\n        }\n    } else {\n        if (window.localStorage.getItem('bttv--theme')) {\n            window.localStorage.removeItem('bttv--theme');\n            $('style#bttv__theme').remove();\n        }\n    }\n});\n\nwindow.BetterTTV = bttv;\n\n},{\"./components/index\":3}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Debug = exports.Debug = function () {\n    function Debug() {\n        _classCallCheck(this, Debug);\n\n        this.__prefix = '[BetterTTV]';\n    }\n\n    _createClass(Debug, [{\n        key: 'log',\n        value: function log(input) {\n            console.log(this.__prefix, input);\n        }\n    }, {\n        key: 'error',\n        value: function error(input) {\n            console.error(this.__prefix, input);\n        }\n    }, {\n        key: 'warn',\n        value: function warn(input) {\n            console.warn(this.__prefix, input);\n        }\n    }]);\n\n    return Debug;\n}();\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Mockups = exports.Debug = undefined;\n\nvar _debug = require('./debug');\n\nvar _mockups = require('./mockups');\n\nexports.Debug = _debug.Debug;\nexports.Mockups = _mockups.Mockups;\n\n},{\"./debug\":2,\"./mockups\":4}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Mockups = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _debug = require('./debug');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Mockups = exports.Mockups = function (_Debug) {\n    _inherits(Mockups, _Debug);\n\n    function Mockups() {\n        _classCallCheck(this, Mockups);\n\n        var _this = _possibleConstructorReturn(this, (Mockups.__proto__ || Object.getPrototypeOf(Mockups)).call(this));\n\n        _this.mockups = {\n            // example: require('../../templates/example.html')\n        };\n        return _this;\n    }\n\n    _createClass(Mockups, [{\n        key: 'get',\n        value: function get() {\n            var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'undefined';\n\n            return this.mockups[name] ? this.mockups[name] : this.error('Mockups: \"' + name + '\" not found');\n        }\n    }]);\n\n    return Mockups;\n}(_debug.Debug);\n\n},{\"./debug\":2}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGpzXFxhcHAuanMiLCJzcmNcXGpzXFxjb21wb25lbnRzXFxkZWJ1Zy5qcyIsInNyY1xcanNcXGNvbXBvbmVudHNcXGluZGV4LmpzIiwic3JjXFxqc1xcY29tcG9uZW50c1xcbW9ja3Vwcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDR0E7O0FBSEEsT0FBTyxPQUFQLENBQWUsV0FBZixDQUEyQixhQUEzQjs7QUFFQTs7O0FBR0E7QUFDQSxJQUFJLE9BQU87QUFDUCxTQUFLO0FBQ0QsaUJBQVksSUFEWDtBQUVELGFBQVksT0FBTyxPQUFQLENBQWUsTUFBZixDQUFzQixFQUF0QjtBQUZYLEtBREU7QUFLUCxhQUFZLG9CQUxMO0FBTVAsV0FBWSxrQkFOTDtBQU9QLGFBQVksT0FBTyxPQUFQLENBQWUsSUFQcEI7QUFRUCxjQUFZO0FBUkwsQ0FBWDs7QUFXQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWlCLFVBQWpCLEVBQTZCLFVBQUUsSUFBRixFQUFZOztBQUVyQztBQUNBLFFBQUssQ0FBQyxPQUFPLElBQVAsQ0FBWSxJQUFaLEVBQWtCLE1BQXhCLEVBQWlDLE9BQU8sS0FBSyxLQUFMLENBQVcsR0FBWCxDQUFlLDhCQUFmLENBQVA7O0FBRWpDO0FBQ0EsU0FBSyxRQUFMLEdBQWdCLEtBQUssUUFBckI7O0FBRUE7QUFDQSxTQUFLLEtBQUwsQ0FBVyxHQUFYLENBQWUsZ0NBQWY7QUFFSCxDQVhEOztBQWFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUksYUFBYSxPQUFPLFlBQVAsQ0FBb0IsT0FBcEIsQ0FBNEIsYUFBNUIsSUFBNkMsS0FBSyxLQUFMLENBQVksT0FBTyxZQUFQLENBQW9CLE9BQXBCLENBQTRCLGFBQTVCLENBQVosQ0FBN0MsR0FBd0csRUFBekg7QUFDQSxFQUFFLDRCQUFGLEVBQWdDLElBQWhDLENBQXNDLFdB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LG9CQUFRLElBQVIsQ0FBYSxLQUFLLFFBQWxCLEVBQTRCLEtBQTVCO0FBQ0g7Ozs7Ozs7Ozs7Ozs7O0FDWkw7O0FBQ0E7O1FBR0ksSztRQUNBLE87Ozs7Ozs7Ozs7OztBQ0xKOzs7Ozs7OztJQUVhLE8sV0FBQSxPOzs7QUFDVCx1QkFBZTtBQUFBOztBQUFBOztBQUdYLGNBQUssT0FBTCxHQUFlO0FBQ1g7QUFEVyxTQUFmO0FBSFc7QUFNZDs7Ozs4QkFFd0I7QUFBQSxnQkFBcEIsSUFBb0IsdUVBQWIsV0FBYTs7QUFDckIsbUJBQU8sS0FBSyxPQUFMLENBQWEsSUFBYixJQUFxQixLQUFLLE9BQUwsQ0FBYSxJQUFiLENBQXJCLEdBQTBDLEtBQUssS0FBTCxnQkFBd0IsSUFBeEIsaUJBQWpEO0FBQ0giLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoJ2NoYW5nZSBpY29uJylcclxuXHJcbi8vIGltcG9ydHNcclxuaW1wb3J0IHsgRGVidWcsIE1vY2t1cHMgfSBmcm9tICcuL2NvbXBvbmVudHMvaW5kZXgnXHJcblxyXG4vLyB2YXJpYWJsZXNcclxubGV0IGJ0dHYgPSB7XHJcbiAgICBkZXY6IHtcclxuICAgICAgICBlbmFibGVkOiAgICB0cnVlLFxyXG4gICAgICAgIGNkbjogICAgICAgIGNocm9tZS5ydW50aW1lLmdldFVSTCgnJylcclxuICAgIH0sXHJcbiAgICBtb2NrdXBzOiAgICBuZXcgTW9ja3VwcyxcclxuICAgIGRlYnVnOiAgICAgIG5ldyBEZWJ1ZyxcclxuICAgIHN0b3JhZ2U6ICAgIGNocm9tZS5zdG9yYWdlLnN5bmMsXHJcbiAgICBzZXR0aW5nczogICB7fVxyXG59XHJcblxyXG4vLyAqKioqKioqKioqKioqKioqXHJcbi8vIFNldHRpbmdzXHJcbi8vICoqKioqKioqKioqKioqKipcclxuXHJcbi8vIGFzeW5jaHJvbm91c2x5IGdldCBhbGwgc2V0dGluZ3NcclxuYnR0di5zdG9yYWdlLmdldCgnc2V0dGluZ3MnLCAoIGl0ZW0gKSA9PiB7XHJcbiAgICBcclxuICAgIC8vIGRvIG5vdGhpbmcgaWYgc2V0dGluZ3MgZG8gbm90IGV4aXN0XHJcbiAgICBpZiAoICFPYmplY3Qua2V5cyhpdGVtKS5sZW5ndGggKSByZXR1cm4gYnR0di5kZWJ1Zy5sb2coJ1NldHRpbmdzOiBub3QgZm91bmQgKGVtcHR5KS4nKVxyXG5cclxuICAgIC8vIHNhdmUgc2V0dGluZ3MgaW50byBhIGdsb2JhbCB2YXJpYWJsZVxyXG4gICAgYnR0di5zZXR0aW5ncyA9IGl0ZW0uc2V0dGluZ3NcclxuXHJcbiAgICAvLyBsb2dcclxuICAgIGJ0dHYuZGVidWcubG9nKCdTZXR0aW5nczogc3VjY2Vzc2Z1bGx5IGxvYWRlZC4nKVxyXG5cclxufSlcclxuXHJcbi8vICoqKioqKioqKioqKioqKipcclxuLy8gVGhlbWVcclxuLy8gKioqKioqKioqKioqKioqKlxyXG5cclxuLy8gZ2V0IHRoZW1lIGZyb20gbG9jYWxTdG9yYWdlXHJcbmxldCBsb2NhbFRoZW1lID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdidHR2LS10aGVtZScpID8gSlNPTi5wYXJzZSggd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdidHR2LS10aGVtZScpICkgOiAnJ1xyXG4kKCc8c3R5bGUgaWQ9XCJidHR2X190aGVtZVwiIC8+JykuaHRtbCggbG9jYWxUaGVtZS5zdHlsZXNoZWV0ICkuYXBwZW5kVG8oJ2hlYWQnKVxyXG5cclxuLy8gd2FpdCBmb3Igc2V0dGluZ3MgdG8gbG9hZFxyXG4kLndoZW4oIGJ0dHYuc2V0dGluZ3MubGVuZ3RoICkudGhlbiggKCkgPT4ge1xyXG5cclxuICAgIGlmICggYnR0di5zZXR0aW5ncy50aGVtZSApIHtcclxuICAgICAgICBsZXQgbmFtZSAgICAgICAgPSBidHR2LnNldHRpbmdzLnRoZW1lXHJcbiAgICAgICAgbGV0IHVybCAgICAgICAgID0gYCR7YnR0di5kZXYuY2RufWNzcy90aGVtZS0ke2J0dHYuc2V0dGluZ3MudGhlbWV9LmNzc2BcclxuICAgICAgICBsZXQgaXNPdXRkYXRlZCAgPSBsb2NhbFRoZW1lID8gKChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIGxvY2FsVGhlbWUubGFzdF91cGRhdGVkKSAvICgxMDAwICogNjAgKiA2MCkpID49IDYgOiB0cnVlXHJcblxyXG4gICAgICAgIC8vIGRvIG5vdCBzaG93IHRoZW1lIGlmIG9sZCBoZWFkZXIgZm91bmRcclxuICAgICAgICBpZiAoICQoJyNzaXRlX2hlYWRlcicpLmxlbmd0aCApIHJldHVyblxyXG5cclxuICAgICAgICAvLyBkaXNhYmxlIHR3aXRjaCdzIGRhcmsgc3R5bGUgZm9yIGNoYXRcclxuICAgICAgICBsZXQgY2hhdFNldHRpbmdzID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NoYXRTZXR0aW5ncycpKVxyXG4gICAgICAgIGlmICggY2hhdFNldHRpbmdzICE9PSBudWxsICYmIGNoYXRTZXR0aW5ncy5kYXJrTW9kZSApIHtcclxuICAgICAgICAgICAgY2hhdFNldHRpbmdzLmRhcmtNb2RlID0gZmFsc2VcclxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCAnY2hhdFNldHRpbmdzJywgSlNPTi5zdHJpbmdpZnkoIGNoYXRTZXR0aW5ncyApIClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGlmIGRldiBtb2RlIGlzIGVuYWJsZWQsIGFwcGVuZCBzdHlsZXNoZWV0IHdpdGhvdXQgY2FjaGluZyBpdFxyXG4gICAgICAgIGlmICggYnR0di5kZXYuZW5hYmxlZCApIHtcclxuICAgICAgICAgICAgJChgPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIHR5cGU9XCJ0ZXh0L2Nzc1wiIGhyZWY9XCIke3VybH1cIj5gKS5hcHBlbmRUbygnaGVhZCcpXHJcblxyXG4gICAgICAgICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdidHR2LS10aGVtZScpKVxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdidHR2LS10aGVtZScpXHJcblxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHVwZGF0ZSB0aGVtZSBpZiBpcyBvdXRkYXRlZCBvciBub3Qgc2F2ZWQgbG9jYWxseVxyXG4gICAgICAgIGlmICggIWxvY2FsVGhlbWUgfHwgaXNPdXRkYXRlZCApIHtcclxuICAgICAgICAgICAgYnR0di5kZWJ1Zy5sb2coJ1RoZW1lOiBzYXZpbmcgc3R5bGVzaGVldCBsb2NhbGx5LicpXHJcblxyXG4gICAgICAgICAgICBsZXQgcmVxdWVzdCA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2VcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJlcXVlc3QuZmFpbCggKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYnR0di5kZWJ1Zy5lcnJvcignVGhlbWU6IGNvdWxkIG5vdCBjb25uZWN0IHRvIHRoZSBzZXJ2ZXIuJylcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJlcXVlc3QuZG9uZSggKHN0eWxlc2hlZXQpID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0dHYuZGVidWcubG9nKGBUaGVtZTogcmVjZWl2ZWQgXCIke25hbWV9XCIgc3R5bGVzaGVldC5gKVxyXG5cclxuICAgICAgICAgICAgICAgICQoJ3N0eWxlI2J0dHZfX3RoZW1lJykuaHRtbCggc3R5bGVzaGVldCApXHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHRoZW1lID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZXNoZWV0OiBzdHlsZXNoZWV0XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdidHR2LS10aGVtZScsIEpTT04uc3RyaW5naWZ5KCB0aGVtZSApKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2J0dHYtLXRoZW1lJykgKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYnR0di0tdGhlbWUnKVxyXG4gICAgICAgICAgICAkKCdzdHlsZSNidHR2X190aGVtZScpLnJlbW92ZSgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSlcclxuXHJcbndpbmRvdy5CZXR0ZXJUVFYgPSBidHR2OyIsImV4cG9ydCBjbGFzcyBEZWJ1ZyB7XHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgdGhpcy5fX3ByZWZpeCA9ICdbQmV0dGVyVFRWXSc7XHJcbiAgICB9XHJcbiAgICBsb2cgKGlucHV0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5fX3ByZWZpeCwgaW5wdXQpO1xyXG4gICAgfVxyXG4gICAgZXJyb3IgKGlucHV0KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLl9fcHJlZml4LCBpbnB1dCk7XHJcbiAgICB9XHJcbiAgICB3YXJuIChpbnB1dCkge1xyXG4gICAgICAgIGNvbnNvbGUud2Fybih0aGlzLl9fcHJlZml4LCBpbnB1dCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4vZGVidWcnXHJcbmltcG9ydCB7IE1vY2t1cHMgfSBmcm9tICcuL21vY2t1cHMnXHJcblxyXG5leHBvcnQge1xyXG4gICAgRGVidWcsXHJcbiAgICBNb2NrdXBzXHJcbn0iLCJpbXBvcnQgeyBEZWJ1ZyB9IGZyb20gJy4vZGVidWcnXHJcblxyXG5leHBvcnQgY2xhc3MgTW9ja3VwcyBleHRlbmRzIERlYnVnIHtcclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuICAgICAgICBzdXBlcigpXHJcblxyXG4gICAgICAgIHRoaXMubW9ja3VwcyA9IHtcclxuICAgICAgICAgICAgLy8gZXhhbXBsZTogcmVxdWlyZSgnLi4vLi4vdGVtcGxhdGVzL2V4YW1wbGUuaHRtbCcpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCAobmFtZSA9ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9ja3Vwc1tuYW1lXSA/IHRoaXMubW9ja3Vwc1tuYW1lXSA6IHRoaXMuZXJyb3IoYE1vY2t1cHM6IFwiJHtuYW1lfVwiIG5vdCBmb3VuZGApXHJcbiAgICB9XHJcbn0iXX0=\n"]}